<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KK Sunflower 國際物流訂單查詢</title>
<style>
  body { font-family: Arial, sans-serif; background:#f0f2f5; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
  .container { background:#fff; padding:40px 30px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.1); text-align:center; width:90%; max-width:400px; }
  h2 { margin:0 0 16px 0; font-size:20px; }
  select, input[type="text"], button { width:100%; padding:12px; margin-bottom:12px; font-size:16px; border-radius:6px; border:1px solid #ccc; box-sizing:border-box; }
  button { border:none; background:#4CAF50; color:#fff; cursor:pointer; }
  button:hover { background:#45a049; }
  #description { font-size:14px; color:#555; margin-top:12px; }
  #result { margin-top:20px; padding:12px; background:#f4f4f4; border-radius:6px; font-weight:bold; }
  #statusDesc { margin-top:10px; font-size:14px; color:#333; text-align:left; white-space:pre-line; }
</style>
</head>
<body>
<div class="container">
  <h2>KK Sunflower 國際物流<br>訂單狀態查詢</h2>

  <!-- 資料來源選擇 -->
  <select id="source">
    <option value="">--請選擇資料來源--</option>
    <option value="A1">A1</option>
    <option value="A1-A">A1-A</option>
    <option value="A2">A2</option>
    <option value="A2-A">A2-A</option>
    <option value="A3">A3</option>
    <option value="A3-A">A3-A</option>
    <option value="A4">A4</option>
    <option value="B2">B2</option>
    <option value="B3">B3</option>
    <option value="B5">B5</option>
    <option value="C2">C2</option>
    <option value="C2-DE">C2-DE</option>
  </select>

  <input id="order" type="text" placeholder="請輸入訂單號" />
  <button id="btn">查詢</button>
  <div id="description">請先選擇資料來源，再輸入訂單號並按「查詢」</div>
  <div id="result"></div>
  <div id="statusDesc"></div>

  <!-- 查詢表單下方圖片 -->
<img src="https://kksunflowerusa.github.io/logo/KK%20logo.png"
     alt="物流圖片"
     style="display:block; margin:20px auto 0; width:200px; height:200px; object-fit:contain;">
</div>

<script>
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwtOLTAfDgSmjjddoVJGxmmk0_pBJL38OkiEfv4rFZDKL2d8VuNyAuK87s-5Tia7xLS/exec'; // ←改成你的 Apps Script URL

// 狀態說明對照表
const statusMap = {
  "新訂單": "新成立訂單",
  "新竹物流取件已安排": "表示已經委派台灣物流去取件",
  "包裹抵達轉運站": "表示訂單已全部抵達轉運站",
  "包裹自行寄往轉運站": "表示訂單由客戶端自行寄到TW轉運站",
  "包裹等待整併中": "表示訂單仍在等待重新打包",
  "台灣寄往美國中": "表示訂單已從台灣寄出，尚未抵達美國",
  "包裹抵達美國": "表示訂單已抵達美國轉運站，等待寄出",
  "美國國內轉運寄出": "表示訂單已從美國轉運站寄出前往收件地址",
  "訂單已完成": "表示訂單已全部完成",
  "訂單已取消": "表示訂單已取消",
  "訂單已更改": "表示訂單已更改表單",
  "訂單尚未更新": "目前尚無更新資訊"
};

const sourceEl = document.getElementById('source');
const inputEl = document.getElementById('order');
const btnEl = document.getElementById('btn');
const resultEl = document.getElementById('result');
const descEl = document.getElementById('description');
const statusDescEl = document.getElementById('statusDesc');

function checkOrder() {
  const order = inputEl.value.trim();
  const source = sourceEl.value;
  if (!source || !order) {
    resultEl.textContent = '';
    statusDescEl.textContent = '';
    descEl.textContent = '請選擇資料來源並輸入訂單號';
    return;
  }

  descEl.textContent = '';
  resultEl.textContent = '查詢中…';
  statusDescEl.textContent = '';

  fetch(`${SCRIPT_URL}?source=${encodeURIComponent(source)}&order=${encodeURIComponent(order)}`)
    .then(r => r.text()) // ★ 使用 text()，因為 Apps Script 回傳純文字
    .then(txt => {
      const st = txt.trim() || "訂單尚未更新";
      resultEl.textContent = `狀態：${st}`;
      statusDescEl.textContent = statusMap[st] || "無對應說明";
    })
    .catch(err => {
      console.error(err);
      resultEl.textContent = '查詢失敗，請稍後再試';
      statusDescEl.textContent = '';
    });
}

btnEl.addEventListener('click', checkOrder);
inputEl.addEventListener('keyup', e => { if(e.key === 'Enter') checkOrder(); });
</script>
</body>
</html>

